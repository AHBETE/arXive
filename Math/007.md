绕行的绕行 (detour of the detour).

### 二项式展开 (binomial expension)

**二项式展开**指的是将类似 $$(x+y)^n$$ 的表达式展开的过程. 结论上有

$$\boxed{(x+y)^n=\sum_{r=0}^n\binom{n}{r}x^{n-r}y^r}.$$

这里 $$\binom{n}{r}=\frac{n!}{r!(n-r)!}$$ 也记作 $$_nC_r$$, 这个"C"是**组合** (combination) 的意思, 其中又有 $$n!=n\times(n-1)\times...\times3\times2\times1$$.

> 上面第一次出现了求和符号 $$\sum$$, 在此用一些例子说明, 
>
> $$\sum_{i=1}^{10}i=1+2+3+...+9+10;$$
>
> $$\sum_{x=1}^{10}x^2=\left.x^2\right|_{x=1}+\left.x^2\right|_{x=2}+...+\left.x^2\right|_{x=10}=1^2+2^2+...+10^2.$$
>
> 即, 求和符号后的表达式, 依次代入求和符号下方的值, 符号下方的值加一..., 直至代入求和符号上方的值, 最后将这些项求和.

二项式展开的证明思路如下:

**从组合的思路出发**

- 将 $$(x+y)^n=\underbrace{(x+y)(x+y)...(x+y)}_{n}$$ 展开, 并将同类项合并, 易见可能出现的项的形式仅为 $$x^n=x^ny^0$$, $$x^{n-1}y=x^{n-1}y^1$$, $$x^{n-2}y^2$$, ... $$x^2y^{n-2}$$, $$xy^{n-1}=x^1y^{n-1}$$, $$y^n=x^0y^n$$. 

- 合并后这些项的系数是合并前它们分别出现的次数,

  - $$x^n$$ 相当于展开时每一个 $$(x+y)$$ 都选取 $$x$$ 的情况, 只有一种这样的情况, 即合并前 $$x^n$$ 只可能出现 $$1$$ 次, 那么合并后它的系数便是 $$1$$.
  - $$(x^{n-1}y^1)$$ 相当于展开时每一个 $$(x+y)$$ 选取了 $$(n-1)$$ 个 $$x$$ 和 $$1$$ 个 $$y$$, 利用组合学的知识有 $$n=\frac{n!}{1!(n-1)!}$$ 种这样的情况, 即合并前 $$(x^{n-1}y^1)$$ 出现 $$n$$ 次, 那么合并后它的系数便是 $$n$$.

  > 这个 $$n$$ 可以这么看待, 选取的这个 $$y$$ 可以出自这 $$n$$ 项 $$(x+y)$$ 中的任意一个, 于是便有 $$n$$ 种可能.

  - $$(x^{n-2}y^2)$$ 相当于展开时每一个 $$(x+y)$$ 选取了 $$(n-2)$$ 个 $$x$$ 和 $$2$$ 个 $$y$$, 利用组合学的知识有 $$\frac{n(n-1)}{2!}=\frac{n!}{1!(n-1)!}$$ 种这样的情况, 即合并前 $$(x^{n-1}y^1)$$ 出现 $$n$$ 次, 那么合并后它的系数便是 $$n$$.

  > 这个 $$\frac{n(n-1)}{2!}$$ 可以这么看待, 选取的这两个 $$y$$ 可以出自这 $$n$$ 项 $$(x+y)$$ 中的任意两个, 第一个 $$y$$ 有 $$n$$ 种选法, 第二个因为第一个"占用"了一个 $$(x+y)$$, 因此它只有 $$(n-1)$$ 种选法, 综上便有了 $$n(n-1)$$; 然后两个 $$y$$ 的顺序是无所谓的, 两个 $$y$$ 本身先后的排序会额外引入一个倍数 $$2$$, 于是除掉.

  - ...
  - $$(x^{n-r}y^r)$$ 相当于展开时每一个 $$(x+y)$$ 选取了 $$(n-r)$$ 个 $$x$$ 和 $$r$$ 个 $$y$$, 利用组合学的知识有 $$\frac{n(n-1)...(n-r)}{(n-r)!}=\frac{n!/r!}{(n-r)!}=\frac{n!}{1!(n-1)!}=\binom{n}{r}$$ 种这样的情况, 即合并前 $$(x^{n-1}y^1)$$ 出现 $$\binom{n}{r}$$ 次, 那么合并后它的系数便是 $$\binom{n}{r}$$.

  > 这个 $$\frac{n(n-1)...(n-r)}{(n-r)!}$$ 可以这么看待, 选取的这 $$r$$ 个 $$y$$ 可以出自这 $$n$$ 项 $$(x+y)$$ 中的任意 $$r$$ 个, 第一个 $$y$$ 有 $$n$$ 种选法, 第二个因为第一个"占用"了一个 $$(x+y)$$, 因此它只有 $$(n-1)$$ 种选法, 第三个于是只有 $$(n-2)$$ 种... 综上便有了 $$n(n-1)...(n-r)$$; 
  > 然后 $$r$$ 个 $$y$$ 的顺序是无所谓的, $$r$$ 个 $$y$$ 本身先后的排序, 第一个 $$y$$ 顺序可能是 $$1$$ 至 $$r$$, 有 $$r$$ 种选择,  第二个只有 $$(r-1)$$... 于是会额外引入一个倍数 $$r(r-1)...1=r!$$, 于是除掉.

- 可见某一项 $$(x^{n-r}y^r)$$, 系数应为 $$\binom{n}{r}$$, $$r=0$$  至 $$r=n$$ 的项都是允许的, 于是利用求和符号表示, 便有了最开始的结论.

这样的思路也可以推出杨辉三角 (Pascal's Triangle):

```matlab
    1
   1  1
  1  2  1
 1  3  3  1
1  4  6  4  1
```

三角的左右两边由 $$1$$ 填满, 中间的某个数字是左上和右上两个数字之和. 不难发现, 从第二行开始, 每一行的数字是都是二项式展开的系数.

上述的推导, 和类似【抛 $$n$$ 次公平的硬币, 得到 $$r$$ 次正面和 $$(n-r)$$ 次反面】的场景有着非常深的联系, 这里暂时不做展开.

**数学归纳法**

这个方法一般只能用于证明, 不能用于推导.

> **数学归纳法** (proof by induction) 思路如下
>
> 1. **归纳奠基** (base case), 证明第一个情况是对的;
> 2. 归纳递推, 假设第 $$n$$ 个情况正确, 以此推出第 $$(n+1)$$ 个情况正确, 便有所有情况都成立.
>
> 已知若情况n成立便有情况(n+1)也成立; 因为有情况1成立, 于是代入n=1, 便有情况2也成立; 现在知道情况2也成立了, 继续代入n=2, 便有情况3也成立...

思路已经给到, 具体证明留作练习. 一点提示是 $$\binom{r}{n+1}=\binom{r}{n}+\binom{r-1}{n}$$.

**应用**

除了常规的 $$n$$ 是整数的一些应用, 在保证展开的形式是**收敛** (coverge) 的情况下 (即求和的形式不会趋向于正/负无穷), 二项式展开的负整数, 甚至分数形式也是成立的.

例如狭义相对论 (special relativity) 中, 随着物体运动速度变化, 物体的相对论性质量 (relativitic mass)[^1]会变大, 它和静止质量 $$m_0$$ 符合关系式

$$m=\frac{m_0}{\sqrt{1-v^2/c^2}}.$$

上式中 $$v$$ 时速度, $$c$$ 是光速. 根据幂运算的规律 (复习【002】), 上式可以改写成

$$m=m_0(1-v^2/c^2)^{-1/2}.$$

在估算例如速度在 $$0.01c$$ 或更小时, 相对论性质量与静止质量之差, 直接计算 $$(m-m_0)$$ 通常看不出 $$m$$ 与 $$m_0$$ 的区别[^2]; 事实上, 我们可以利用二项式展开, 因为

$$(1+x)^n=1+nx+\frac{n(n-1)}{2!}x^2+...,$$

代入 $$x=(v^2/c^2)$$ 与 $$n=\frac{1}{2}$$ 便有

$$m=m_0\left(1+(-1/2)\left(-\frac{v^2}{c^2}\right)+\frac{(-1/2)(-1/2-1)}{2!}\left(-\frac{v^2}{c^2}\right)^2\right)=m\left(1+\frac{v^2}{2c^2}+\frac{3}{8}\frac{v^4}{c^4}+...\right).$$

这个形式下, 相对论性质量与静止质量之差就很明显

$$m\left(\frac{v^2}{2c^2}+\frac{3}{8}\frac{v^4}{c^4}+...\right),$$

利用前几项便可以得到很好的近似.

[^1]: 静止质量是物体静止时的质量, 或者说某个观察者发现某物体处于静止状态下时这个物体的质量; 相对论性质量则是物体相对观察者具有一定速度时, 观察者观察到的质量.
[^2]: 计算机保存的并不是准确值, 而是浮点数 (暂不展开), 可以暂且不太正确但道理就这么个道理地理解为: 它保存的答案是一个写成科学计数法的数值, 并且位数有限, 超过一定位数的部分就被切掉了; 于是两个很接近的数字在计算机看来有可能是相等的, 进而计算不出差值.